name: openchrom
base: core20

version: '1.4.0.202201211106'
summary: Visualization and Analysis of mass spectrometric and chromatographic data.
description:
  OpenChromÂ® is an Open Source tool for the analysis and visualization of
  mass spectrometric and chromatographic data developed by Lablicate GmbH.

grade: stable
confinement: strict

architectures:
  - build-on: amd64

apps:
  openchrom:
    extensions: [gnome-3-38]
    command: bin/openchrom-wrapper
    environment:
      GTK2_RC_FILES: $SNAP/usr/share/themes/Yaru/gtk-2.0/gtkrc
      GTK_PATH: $SNAP/usr/lib/$SNAPCRAFT_ARCH_TRIPLET/gtk-2.0
    plugs:
      - browser-support
      - home
      - mount-observe
      - network
      - network-bind
      - raw-usb
      - removable-media

parts:
  openchrom:
    plugin: dump
    source: https://products.lablicate.com/openchrom/1.4.x/openchrom-lablicate_linux.x86_64_1.4.x.tar.gz
    override-build: |
      snapcraftctl build
      sed -i 's;@user.home/;@user.home/snap/openchrom/current/;' $SNAPCRAFT_PART_INSTALL/openchrom.ini
    stage-packages:
      - libusb-1.0-0
  wrappers:
    plugin: dump
    source: snap/local/wrappers
    organize:
      openchrom: bin/openchrom-wrapper
  gtk-2:
    plugin: nil
    stage-packages:
      - yaru-theme-gtk
      - libgtk2.0-0
